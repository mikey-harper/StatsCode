---
title: "Testing mtcars"
author: "Ben Anderson"
date: 'Last run at: `r Sys.time()`'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Test partition by transmission

ggplot visualisation of the model
```{r testPartition}
mtcarsDT <- as.data.table(mtcars)
mtcarsDT <- mtcarsDT[, transmission := factor(am, labels = c("Automatic", "Manual"))]
ggplot(mtcarsDT, aes(x=qsec, y=mpg, color=transmission)) +
    geom_point(shape=1) +    # Use hollow circles
    # theme(legend.position="bottom") +
    geom_smooth(method=lm,
                se = FALSE)   # Add linear regression line 
                             #  (by default includes 95% confidence region)
```

## Create model estimation results suitable for graphing with 95% CI

```{r testPlot}
mpgModel2 <- lm(mpg ~ qsec + wt, mtcarsDT)

# basic results
summary(mpgModel2)

library(broom)    
mpgModel2DF <- tidy(mpgModel2)
mpgModel2DF$ci_lower <- mpgModel2DF$estimate - qnorm(0.975) * mpgModel2DF$std.error
mpgModel2DF$ci_upper <- mpgModel2DF$estimate + qnorm(0.975) * mpgModel2DF$std.error

ggplot(mpgModel2DF, aes(x=term, y=estimate)) + 
    geom_bar(position=position_dodge(), stat="identity", fill = "yellowgreen") +
    geom_errorbar(aes(ymin=ci_lower, ymax=ci_upper),
                  width=.2,                    # Width of the error bars
                  position=position_dodge(.9)
                  )
```